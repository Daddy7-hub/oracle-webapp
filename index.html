<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>CryptoATM.tech ‚Äî Mini App</title>
  <meta name="color-scheme" content="dark light">

  <!-- Telegram WebApp SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <!-- Inter font (–ª–µ–≥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #0b0d12;
      --panel: #11151d;
      --card: rgba(255,255,255,0.04);
      --muted: #98a2b3;
      --txt: #e6e9f0;
      --brand: #7c4dff;     /* —Ñ–∏–æ–ª–µ—Ç */
      --brand-2:#00e5ff;    /* –Ω–µ–æ–Ω-–≥–æ–ª—É–±–æ–π */
      --accent:#27e1a7;     /* –º—è—Ç–∞ */
      --danger:#ff5c7c;
      --gold: #f4c95d;

      --radius-xl: 18px;
      --radius-lg: 14px;
      --radius-md: 12px;
      --radius-sm: 10px;

      --shadow-1: 0 10px 30px rgba(0,0,0,.35);
      --shadow-2: 0 12px 40px rgba(124,77,255,.20);
      --shadow-3: 0 10px 40px rgba(0,229,255,.15);
      --glass: rgba(255,255,255,0.06);
      --glass-brd: 1px solid rgba(255,255,255,0.08);
      --grad-1: linear-gradient(135deg, rgba(124,77,255,.2), rgba(0,229,255,.15));
      --grad-2: linear-gradient(135deg, rgba(39,225,167,.15), rgba(124,77,255,.15));
    }

    * { box-sizing: border-box; }
    html, body { height:100%; }
    body{
      margin:0; background: radial-gradient(1200px 600px at 80% -10%, rgba(124,77,255,.12), transparent),
                 radial-gradient(1200px 800px at -20% 120%, rgba(0,229,255,.10), transparent),
                 var(--bg);
      color: var(--txt); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }

    .wrap{ max-width:980px; margin:0 auto; padding:20px 16px 28px; }
    header{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:12px; margin:8px 0 16px;
      background: var(--glass); border: var(--glass-brd); border-radius: var(--radius-xl);
      box-shadow: var(--shadow-1);
      backdrop-filter: blur(8px);
    }
    .brand{
      display:flex; gap:12px; align-items:center;
    }
    .logo{
      width:44px; height:44px; border-radius:12px;
      background: conic-gradient(from 210deg, var(--brand), var(--brand-2), var(--accent), var(--brand));
      box-shadow: 0 0 0 1px rgba(255,255,255,.08) inset, var(--shadow-2);
    }
    .brand h1{ font-size:18px; margin:0 0 2px; letter-spacing:.2px; }
    .brand p{ margin:0; color: var(--muted); font-size:12px; }
    .balance{
      display:flex; gap:10px; align-items:center; background: var(--card); padding:10px 12px; border-radius:12px;
      border: var(--glass-brd);
    }
    .chip{
      padding:6px 10px; border-radius:999px; background: rgba(124,77,255,.18);
      border: 1px solid rgba(124,77,255,.35); color:#d7c9ff; font-weight:600; font-size:12px;
    }

    /* Tabs */
    .tabs{ display:flex; gap:8px; flex-wrap:wrap; margin: 14px 0 18px; }
    .tab{
      appearance:none; border:0; background: var(--card);
      color:var(--txt); padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:600;
      border: var(--glass-brd);
      transition: transform .15s ease, background .2s ease, box-shadow .2s ease;
    }
    .tab:hover{ transform: translateY(-1px); }
    .tab.active{ background: var(--grad-1); box-shadow: var(--shadow-2); }

    /* Grid/cards */
    .grid{ display:grid; grid-template-columns: repeat(12,1fr); gap:14px; }
    .col-12{ grid-column: span 12; }
    .col-6{ grid-column: span 6; }
    .col-4{ grid-column: span 4; }
    .card{
      background: var(--glass); border: var(--glass-brd); border-radius: var(--radius-xl);
      padding:16px; box-shadow: var(--shadow-1);
    }
    .card h3{ margin:0 0 10px; font-size:16px; }
    .muted{ color: var(--muted); font-size:13px; }

    .cta{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px; border-radius:12px; font-weight:700; color:#0b0d12;
      background: linear-gradient(135deg, var(--brand-2), var(--accent));
      border: 0; cursor:pointer; box-shadow: var(--shadow-3);
      transition: transform .12s ease, box-shadow .2s ease;
    }
    .cta:hover{ transform: translateY(-1px); }
    .cta.ghost{
      background: transparent; color: var(--txt); border: 1px dashed rgba(255,255,255,.25);
    }

    /* Forms */
    .field{ display:flex; flex-direction:column; gap:6px; margin:10px 0 12px; }
    label{ font-size:12px; color: var(--muted); }
    input, select, textarea{
      width:100%; padding:12px 12px; border-radius:12px; border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04); color: var(--txt); outline: none;
      transition: border-color .15s ease, background .2s ease;
      font-family: inherit; font-size:14px;
    }
    textarea{ min-height:110px; resize: vertical; }
    input:focus, select:focus, textarea:focus{
      border-color: rgba(124,77,255,.6); background: rgba(255,255,255,.06);
      box-shadow: 0 0 0 3px rgba(124,77,255,.15) inset;
    }
    .row{ display:flex; gap:10px; flex-wrap:wrap; }

    .bot-tag{
      display:inline-flex; align-items:center; gap:6px; font-size:12px;
      color:#cde9ff; background: rgba(0,229,255,.12); border:1px solid rgba(0,229,255,.35);
      padding:5px 10px; border-radius:999px; font-weight:600;
    }

    .notice{
      padding:12px 14px; border-radius:12px; background: rgba(39,225,167,.12);
      border:1px solid rgba(39,225,167,.35); color:#d5ffef; font-size:13px;
    }
    .danger{ background: rgba(255,92,124,.12); border-color: rgba(255,92,124,.35); color:#ffd6df; }

    .footer{
      margin: 22px 0 8px; color:var(--muted); font-size:12px; text-align:center;
    }

    @media (max-width: 900px){
      .col-6{ grid-column: span 12; }
      .col-4{ grid-column: span 12; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>CryptoATM.tech</h1>
          <p>–ø–æ–¥–ø–∏—Å–∫–∏ ‚Ä¢ —Ç–æ–∫–µ–Ω—ã ‚Ä¢ –∑–∞–¥–∞–Ω–∏—è ‚Ä¢ —Ä–æ–∑—ã–≥—Ä—ã—à–∏</p>
        </div>
      </div>
      <div class="balance">
        <span class="chip" id="chip-user">guest</span>
        <span class="chip" id="chip-tokens">0 —Ç–æ–∫–µ–Ω–æ–≤</span>
      </div>
    </header>

    <!-- Tabs -->
    <div class="tabs" role="tablist" aria-label="–ì–ª–∞–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
      <button class="tab active" data-tab="home">üè† –ì–ª–∞–≤–Ω–∞—è</button>
      <button class="tab" data-tab="pricing">üíé –¢–∞—Ä–∏—Ñ—ã</button>
      <button class="tab" data-tab="bots">ü§ñ –ë–æ—Ç—ã</button>
      <button class="tab" data-tab="buy">üí∏ –¢–æ–∫–µ–Ω—ã</button>
      <button class="tab" data-tab="sub">üßæ –ü–æ–¥–ø–∏—Å–∫–∞</button>
      <button class="tab" data-tab="tasks">üß© –ó–∞–¥–∞–Ω–∏—è</button>
      <button class="tab" data-tab="ref">üë• –†–µ—Ñ–µ—Ä–∞–ª</button>
      <button class="tab" data-tab="raffle">üèÜ –†–æ–∑—ã–≥—Ä—ã—à</button>
      <button class="tab" data-tab="faq">‚ùì FAQ</button>
    </div>

    <!-- Panels -->
    <section id="tab-home" class="grid">
      <div class="col-12 card" style="background:var(--grad-2);">
        <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h3>
        <p class="muted">–≠—Ç–æ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏ Telegram. –ó–∞ –ø–æ–∫—É–ø–∫–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —Ç–æ–∫–µ–Ω—ã ‚Äî –æ–Ω–∏ –ø–æ–≤—ã—à–∞—é—Ç —à–∞–Ω—Å –≤—ã–∏–≥—Ä–∞—Ç—å –ø—Ä–∏–∑ –≤ –µ–∂–µ–º–µ—Å—è—á–Ω–æ–º —Ä–æ–∑—ã–≥—Ä—ã—à–µ.</p>
        <div class="row" style="margin-top:8px;">
          <button class="cta" onclick="openTab('buy')">–ö—É–ø–∏—Ç—å —Ç–æ–∫–µ–Ω—ã</button>
          <button class="cta ghost" onclick="openTab('tasks')">–ö –∑–∞–¥–∞–Ω–∏—è–º</button>
        </div>
      </div>

      <div class="col-6 card">
        <h3>–í–∞—à —Å—Ç–∞—Ç—É—Å</h3>
        <div class="muted" id="status-box">
          –ó–∞–≥—Ä—É–∑–∏–ª–∏ –∏–∑ Telegram: <span id="whoami">‚Ä¶</span><br/>
          –†–µ—Ñ-–∫–æ–¥: <code id="refcode">‚Äî</code>
        </div>
      </div>

      <div class="col-6 card">
        <h3>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
        <div class="row">
          <button class="cta" onclick="sendInfo('pricing')">–ü–æ–∫–∞–∑–∞—Ç—å —Ç–∞—Ä–∏—Ñ—ã –≤ —á–∞—Ç–µ</button>
          <button class="cta" onclick="sendInfo('bots')">–ü–æ–∫–∞–∑–∞—Ç—å –±–æ—Ç–æ–≤ –≤ —á–∞—Ç–µ</button>
          <button class="cta" onclick="sendInfo('faq')">–ü–æ–∫–∞–∑–∞—Ç—å FAQ</button>
        </div>
      </div>
    </section>

    <section id="tab-pricing" class="grid" hidden>
      <div class="col-12 card">
        <h3>–¢–∞—Ä–∏—Ñ—ã</h3>
        <p class="muted">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–ª–∞–Ω, –æ—Ñ–æ—Ä–º–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É –∏ –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –Ω—É–∂–Ω—ã–º –±–æ—Ç–∞–º.</p>
      </div>
      <div id="pricing-cards" class="col-12 grid"></div>
    </section>

    <section id="tab-bots" class="grid" hidden>
      <div class="col-12 card">
        <h3>–ù–∞—à–∏ –ø—Ä–æ–¥—É–∫—Ç—ã</h3>
        <div id="bots-cards" class="grid"></div>
      </div>
    </section>

    <section id="tab-buy" class="grid" hidden>
      <div class="col-12 card">
        <h3>–ü–æ–∫—É–ø–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤</h3>
        <div class="notice">–û–ø–ª–∞—Ç–∞ USDT. –ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ –º—ã –∑–∞—á–∏—Å–ª–∏–º –º–æ–Ω–µ—Ç—ã –Ω–∞ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.</div>
        <div class="row">
          <div class="field" style="flex:1;">
            <label for="buy-amount">–°—É–º–º–∞ (USDT)</label>
            <input id="buy-amount" type="number" min="5" step="1" value="25" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, 25">
          </div>
          <div class="field" style="flex:1;">
            <label for="buy-chain">–°–µ—Ç—å</label>
            <select id="buy-chain">
              <option value="TRC20">TRON (TRC20)</option>
              <option value="BEP20">BNB Smart Chain (BEP20)</option>
              <option value="ERC20">Ethereum (ERC20)</option>
            </select>
          </div>
        </div>
        <button class="cta" onclick="buyTokens()">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –∏ –ø–æ–ª—É—á–∏—Ç—å –∞–¥—Ä–µ—Å</button>
      </div>

      <div class="col-12 card">
        <h3>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</h3>
        <ol class="muted">
          <li>–£–∫–∞–∂–∏—Ç–µ —Å—É–º–º—É –∏ —Å–µ—Ç—å, –Ω–∞–∂–º–∏—Ç–µ ¬´–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É¬ª.</li>
          <li>–ë–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –∞–¥—Ä–µ—Å –∏ MEMO –≤ —á–∞—Ç. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ USDT —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º MEMO.</li>
          <li>–û—Ç–≤–µ—Ç—å—Ç–µ ¬´–û–ø–ª–∞—Ç–∏–ª(–∞)¬ª ‚Äî –º—ã –ø—Ä–æ–≤–µ—Ä–∏–º –∏ –∑–∞—á–∏—Å–ª–∏–º —Ç–æ–∫–µ–Ω—ã.</li>
        </ol>
      </div>
    </section>

    <section id="tab-sub" class="grid" hidden>
      <div class="col-12 card">
        <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏</h3>
        <div id="sub-plans" class="grid"></div>
      </div>
      <div class="col-12 card">
        <h3>–û–ø–ª–∞—Ç–∞ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è</h3>
        <p class="muted">–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è ¬´–û—Ñ–æ—Ä–º–∏—Ç—å¬ª, –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –≤ —á–∞—Ç (–∞–¥—Ä–µ—Å USDT –∏ MEMO) ‚Äî –æ–ø–ª–∞—Ç–∏—Ç–µ –∏ –Ω–∞–ø–∏—à–∏—Ç–µ ¬´–û–ø–ª–∞—Ç–∏–ª(–∞)¬ª –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è.</p>
      </div>
    </section>

    <section id="tab-tasks" class="grid" hidden>
      <div class="col-12 card">
        <h3>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h3>
        <p class="muted">–í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è, –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ –ø—Ä—É—Ñ ‚Äî –º–æ–¥–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç –∏ –Ω–∞—á–∏—Å–ª–∏—Ç —Ç–æ–∫–µ–Ω—ã.</p>
        <div class="row" style="gap:8px;margin-bottom:6px;">
          <button class="cta ghost" onclick="requestTaskList()">–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤ —á–∞—Ç–µ</button>
        </div>
        <div id="tasks-cards" class="grid"></div>
      </div>
    </section>

    <section id="tab-ref" class="grid" hidden>
      <div class="col-12 card">
        <h3>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</h3>
        <p class="muted">–û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–∞—à–µ–º—É –¥—Ä—É–≥—É –∫–æ–¥ –≤–∏–¥–∞ <b>REF&lt;–≤–∞—àID&gt;</b>. –ê —Å—é–¥–∞ –º–æ–∂–Ω–æ –ø—Ä–∏–≤—è–∑–∞—Ç—å —Å–≤–æ–π —Ä–µ—Ñ–µ—Ä–∞–ª-–∫–æ–¥, –µ—Å–ª–∏ –≤–∞—Å –∫—Ç–æ-—Ç–æ –ø—Ä–∏–≥–ª–∞—Å–∏–ª.</p>
        <div class="row">
          <div class="field" style="flex:1;">
            <label for="ref-code">–†–µ—Ñ-–∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, REF123456789)</label>
            <input id="ref-code" type="text" placeholder="REF123...">
          </div>
          <div style="display:flex;align-items:flex-end;">
            <button class="cta" onclick="bindRef()">–ü—Ä–∏–≤—è–∑–∞—Ç—å</button>
          </div>
        </div>
        <div class="notice" id="my-refcode">–í–∞—à –∫–æ–¥: ‚Äî</div>
      </div>
    </section>

    <section id="tab-raffle" class="grid" hidden>
      <div class="col-12 card">
        <h3>–ï–∂–µ–º–µ—Å—è—á–Ω—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à</h3>
        <p class="muted">–ö–∞–∂–¥–∞—è –º–æ–Ω–µ—Ç–∞ –ø–æ–≤—ã—à–∞–µ—Ç —à–∞–Ω—Å –ø–æ–±–µ–¥–∏—Ç—å. –ù–∞–∂–º–∏—Ç–µ ¬´–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å¬ª, —á—Ç–æ–±—ã –ø–æ–ø–∞—Å—Ç—å –≤ —Å–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞.</p>
        <button class="cta" onclick="raffleOptIn()">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
        <div class="notice" style="margin-top:10px;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ —á–∞—Ç–µ/–∫–∞–Ω–∞–ª–µ. –ü–æ–±–µ–¥–∏—Ç–µ–ª—é –ø–∏—à–µ—Ç –º–æ–¥–µ—Ä–∞—Ç–æ—Ä.</div>
      </div>
    </section>

    <section id="tab-faq" class="grid" hidden>
      <div class="col-12 card">
        <h3>FAQ</h3>
        <div id="faq-cards" class="grid"></div>
      </div>
    </section>

    <div class="footer">¬© CryptoATM.tech ‚Äî –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Telegram ‚Ä¢ v1.0</div>
  </div>

  <script>
    // ====== Telegram WebApp boot ======
    const tg = window.Telegram?.WebApp;
    if (tg) {
      tg.expand();
      // –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–µ–º—É Telegram
      const th = tg.themeParams || {};
      if (th.bg_color) document.body.style.backgroundColor = th.bg_color;
    }

    // ====== –î–∞–Ω–Ω—ã–µ (–¥–æ–ª–∂–Ω—ã –æ—Ç—Ä–∞–∂–∞—Ç—å –±—ç–∫–µ–Ω–¥) ======
    const SUBSCRIPTION_PLANS = [
      { code:'BASIC',   title:'Basic',   price_usd:19, period:'–º–µ—Å—è—Ü', features:['–î–æ—Å—Ç—É–ø –∫ –±–æ—Ç—É A','–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ —á–∞—Ç–µ'] },
      { code:'PRO',     title:'Pro',     price_usd:39, period:'–º–µ—Å—è—Ü', features:['–ë–æ—Ç—ã A+B','–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞','–ë–æ–ª—å—à–µ –ª–∏–º–∏—Ç–æ–≤'] },
      { code:'PREMIUM', title:'Premium', price_usd:79, period:'–º–µ—Å—è—Ü', features:['–í—Å–µ –±–æ—Ç—ã','–ü—Ä–µ–º–∏—É–º-–∫–∞–Ω–∞–ª','–ß–∞—Å—Ç–Ω–∞—è —Å–µ—Å—Å–∏—è 1/–º–µ—Å'] },
    ];

    const BOTS_CATALOG = [
      { slug:'atm-finder', name:'Crypto ATM Finder', desc:'–ù–∞–π–¥–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π –∫—Ä–∏–ø—Ç–æ-ATM –∏ –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –º–∞—Ä—à—Ä—É—Ç.' },
      { slug:'p2p-guard',  name:'P2P Guard',         desc:'–£–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏ –∞–Ω—Ç–∏-—Ñ—Ä–æ–¥ –ø—Ä–∏ P2P-—Å–¥–µ–ª–∫–∞—Ö.' },
      { slug:'autopay',    name:'AutoPay Script',    desc:'–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è –≤–∞—à–∏—Ö –∫–æ—à–µ–ª—å–∫–æ–≤.' },
    ];

    const TASKS_POOL = [
      { id:1, title:'–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ Instagram', type:'link',  reward:10, active:true,  hint:'–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å –∏–∑ –ø–æ–¥–ø–∏—Å–æ–∫' },
      { id:2, title:'–†–µ–ø–æ—Å—Ç —Å—Ç–æ—Ä–∏—Å',         type:'link',  reward:15, active:true,  hint:'–°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–∏—Å/–∞–∫–∫–∞—É–Ω—Ç' },
      { id:3, title:'–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞',        type:'text',  reward:25, active:true,  hint:'–£–∫–∞–∂–∏ @username –¥—Ä—É–≥–∞' },
      { id:4, title:'–ù–∞–∫–ª–µ–π–∫–∞ –Ω–∞ –∞–≤—Ç–æ',      type:'photo', reward:50, active:false, hint:'–ü–æ–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–æ—Ç–æ' },
    ];

    const FAQ_ITEMS = [
      { q:'–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É?', a:'–°–µ–π—á–∞—Å ‚Äî USDT (TRC20/BEP20/ERC20). –†–µ–∫–≤–∏–∑–∏—Ç—ã –∏ MEMO –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –≤ —á–∞—Ç–µ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è ¬´–û—Ñ–æ—Ä–º–∏—Ç—å¬ª.' },
      { q:'–ß—Ç–æ –∑–∞ —Ç–æ–∫–µ–Ω—ã?', a:'–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –º–æ–Ω–µ—Ç—ã ‚Äî –¥–∞—é—Ç—Å—è –∑–∞ –ø–æ–∫—É–ø–∫–∏ –∏ –∑–∞–¥–∞–Ω–∏—è; –ø–æ–≤—ã—à–∞—é—Ç —à–∞–Ω—Å –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–µ.' },
      { q:'–ï—Å—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∞?', a:'–î–∞: –∫–æ–¥ —Ñ–æ—Ä–º–∞—Ç–∞ REF<ID>. –ü—Ä–∏–≤—è–∂–∏—Ç–µ –∫–æ–¥ –ø—Ä–∏–≥–ª–∞—Å–∏–≤—à–µ–≥–æ ‚Äî –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–Ω—É—Å—ã.' },
    ];

    // ====== –®–∞–±–ª–æ–Ω—ã –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ ======
    const q = (sel) => document.querySelector(sel);
    const mk = (tag, props={}) => Object.assign(document.createElement(tag), props);

    function renderPricing(){
      const holder = q('#pricing-cards');
      holder.innerHTML = '';
      SUBSCRIPTION_PLANS.forEach(p=>{
        const card = mk('div', { className:'col-4 card' });
        const feats = p.features.map(f => `<span class="bot-tag">${f}</span>`).join(' ');
        card.innerHTML = `
          <h3>${p.title}</h3>
          <div class="muted">\$${p.price_usd}/${p.period}</div>
          <div style="margin:10px 0 12px; display:flex; gap:8px; flex-wrap:wrap;">${feats}</div>
          <button class="cta" onclick="subscribe('${p.code}')">–û—Ñ–æ—Ä–º–∏—Ç—å</button>
        `;
        holder.appendChild(card);
      });
    }

    function renderBots(){
      const holder = q('#bots-cards');
      holder.innerHTML = '';
      BOTS_CATALOG.forEach(b=>{
        const card = mk('div', { className:'col-6 card' });
        card.innerHTML = `
          <h3>${b.name}</h3>
          <p class="muted">${b.desc}</p>
          <span class="bot-tag">–î–æ—Å—Ç—É–ø –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ</span>
        `;
        holder.appendChild(card);
      });
    }

    function renderTasks(){
      const holder = q('#tasks-cards');
      holder.innerHTML = '';
      TASKS_POOL.filter(t=>t.active).forEach(t=>{
        const card = mk('div', { className:'col-6 card' });
        card.innerHTML = `
          <h3>#${t.id} ‚Äî ${t.title}</h3>
          <p class="muted">–ü—Ä—É—Ñ: <b>${t.type}</b> ‚Ä¢ –ù–∞–≥—Ä–∞–¥–∞: +${t.reward} —Ç–æ–∫–µ–Ω–æ–≤</p>
          <div class="field">
            <label>–í–∞—à –ø—Ä—É—Ñ (${t.type === 'text' ? '—Ç–µ–∫—Å—Ç' : '—Å—Å—ã–ª–∫–∞'})</label>
            <input id="task-proof-${t.id}" type="text" placeholder="${t.hint}">
          </div>
          <button class="cta" onclick="submitTask(${t.id})">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        `;
        holder.appendChild(card);
      });
    }

    function renderFAQ(){
      const holder = q('#faq-cards');
      holder.innerHTML = '';
      FAQ_ITEMS.forEach(item=>{
        const card = mk('div', { className: 'col-12 card' });
        card.innerHTML = `<h3>${item.q}</h3><p class="muted">${item.a}</p>`;
        holder.appendChild(card);
      });
    }

    // ====== –ù–∞–≤–∏–≥–∞—Ü–∏—è ======
    function openTab(name){
      document.querySelectorAll('.tab').forEach(b=>b.classList.toggle('active', b.dataset.tab===name));
      document.querySelectorAll('section[id^="tab-"]').forEach(s=>s.hidden = s.id !== 'tab-' + name);
      // –æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞
      if (name==='pricing') renderPricing();
      if (name==='bots') renderBots();
      if (name==='tasks') renderTasks();
      if (name==='faq') renderFAQ();
      if (name==='sub') renderPricing(); // –ø–ª–∞–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏ –∑–¥–µ—Å—å
    }
    window.openTab = openTab;

    // ====== –û—Ç–ø—Ä–∞–≤–∫–∞ —ç–∫—à–µ–Ω–æ–≤ –≤ –±–æ—Ç ======
    function sendData(obj){
      const payload = JSON.stringify(obj);
      if (tg && typeof tg.sendData === 'function'){
        tg.sendData(payload);
        toast('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–æ—Ç—É. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏–∞–ª–æ–≥.');
      }else{
        alert('–ù–µ –≤ Telegram. payload:\n' + payload);
      }
    }

    function sendInfo(topic){ sendData({ action:'info', topic }); }
    window.sendInfo = sendInfo;

    function buyTokens(){
      const amount = parseInt(q('#buy-amount').value || '0', 10);
      const chain = q('#buy-chain').value;
      if (!amount || amount < 5){ return toast('–ú–∏–Ω–∏–º—É–º 5 USDT', true); }
      sendData({ action:'buy_tokens', amount, chain });
    }
    window.buyTokens = buyTokens;

    function subscribe(plan){
      sendData({ action:'subscribe', plan });
    }
    window.subscribe = subscribe;

    function requestTaskList(){
      sendData({ action:'tasks_list' });
    }
    window.requestTaskList = requestTaskList;

    function submitTask(task_id){
      const el = q('#task-proof-'+task_id);
      const payload = (el?.value || '').trim();
      if (!payload) return toast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª–µ —Å –ø—Ä—É—Ñ–æ–º', true);
      sendData({ action:'task_submit', task_id, payload });
      el.value = '';
    }
    window.submitTask = submitTask;

    function bindRef(){
      const code = (q('#ref-code').value || '').trim();
      if (!code) return toast('–í–≤–µ–¥–∏—Ç–µ —Ä–µ—Ñ-–∫–æ–¥', true);
      sendData({ action:'ref_bind', code });
    }
    window.bindRef = bindRef;

    function raffleOptIn(){
      sendData({ action:'raffle_optin' });
    }
    window.raffleOptIn = raffleOptIn;

    // ====== UX: Toasts ======
    const toastBox = mk('div',{style:'position:fixed;bottom:22px;left:0;right:0;display:flex;justify-content:center;pointer-events:none;z-index:99;'}); 
    document.body.appendChild(toastBox);
    function toast(msg, danger=false){
      const t = mk('div',{className:'notice'+(danger?' danger':''), textContent: msg});
      t.style.boxShadow='var(--shadow-1)'; t.style.pointerEvents='auto';
      t.style.maxWidth='92%'; t.style.backdropFilter='blur(6px)';
      toastBox.appendChild(t);
      setTimeout(()=>{ t.style.opacity='0'; t.style.transform='translateY(6px)';
        setTimeout(()=>t.remove(), 300);
      }, 1800);
    }

    // ====== Bootstrap UI ======
    function boot(){
      // user chip
      const userId = tg?.initDataUnsafe?.user?.id || 'guest';
      const userName = tg?.initDataUnsafe?.user?.username || tg?.initDataUnsafe?.user?.first_name || 'guest';
      q('#chip-user').textContent = '@' + String(userName);
      q('#whoami').textContent = 'ID ' + String(userId);
      q('#my-refcode').innerHTML = '–í–∞—à –∫–æ–¥: <b>REF'+String(userId)+'</b>';
      // open default tab
      openTab('home');

      // –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ –≤ Telegram ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏–º
      if (!tg){
        toast('–û—Ç–∫—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ Telegram –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏', true);
      }
    }
    boot();
  </script>
</body>
</html>
