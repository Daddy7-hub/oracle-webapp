<!doctype html><!doctype html><!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>CryptoATM.tech ‚Äî Mini App</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --card: 255 255 255; --muted: 248 250 252; }
    .card { background: rgb(var(--card)); border-radius: 16px; box-shadow: 0 10px 24px rgba(0,0,0,.07); }
    .tap-btn { user-select: none; -webkit-user-select: none; }
    .badge { background: #0ea5e9; color: white; border-radius: 999px; padding: 2px 8px; font-size: 12px; }
    .muted { color:#6b7280; }
  </style>
</head>
<body class="bg-slate-100 text-slate-900">
  <div id="app" class="max-w-3xl mx-auto px-3 py-4">
    <header class="mb-4">
      <h1 class="text-2xl font-bold">CryptoATM.tech</h1>
      <div class="text-sm muted">–¢–∞—Ä–∏—Ñ—ã ‚Ä¢ –ö–æ—Ä–∑–∏–Ω–∞ ‚Ä¢ ATM –º–æ–Ω–µ—Ç—ã ‚Ä¢ –ó–∞–¥–∞–Ω–∏—è ‚Ä¢ –†–æ–∑—ã–≥—Ä—ã—à</div>
    </header>

    <nav class="grid grid-cols-2 gap-2 mb-4">
      <button data-tab="plans" class="tab-btn px-3 py-2 card text-left">üì¶ –¢–∞—Ä–∏—Ñ—ã</button>
      <button data-tab="cart" class="tab-btn px-3 py-2 card text-left">üõí –ö–æ—Ä–∑–∏–Ω–∞ <span id="cart-count" class="badge ml-2 hidden">0</span></button>
      <button data-tab="wallet" class="tab-btn px-3 py-2 card text-left col-span-2">üëõ –ö–æ—à–µ–ª—ë–∫ & –¢–∞–ø–∞–ª–∫–∞</button>
      <button data-tab="tasks" class="tab-btn px-3 py-2 card text-left">üß© –ó–∞–¥–∞–Ω–∏—è</button>
      <button data-tab="raffle" class="tab-btn px-3 py-2 card text-left">üèÜ –†–æ–∑—ã–≥—Ä—ã—à</button>
      <button data-tab="ref" class="tab-btn px-3 py-2 card text-left">üë• –†–µ—Ñ–µ—Ä–∞–ª—ã</button>
    </nav>

    <section id="plans" class="tab hidden">
      <div class="card p-4 mb-4">
        <h2 class="text-xl font-semibold mb-2">–¢–∞—Ä–∏—Ñ—ã</h2>
        <p class="muted text-sm mb-2">–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ –æ—Ñ–æ—Ä–º–ª—è–π—Ç–µ ‚Äî –∑–∞ EUR –∏–ª–∏ –º–æ–Ω–µ—Ç—ã ATM.</p>
        <div id="plans-list" class="grid gap-3"></div>
      </div>
    </section>

    <section id="cart" class="tab hidden">
      <div class="card p-4 mb-4">
        <div class="flex items-center justify-between">
          <h2 class="text-xl font-semibold">–ö–æ—Ä–∑–∏–Ω–∞</h2>
          <button id="btn-clear-cart" class="text-sm underline">–æ—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        <div id="cart-list" class="grid gap-2 my-3"></div>
        <div class="flex items-center justify-between mt-2">
          <div class="font-semibold">–ò—Ç–æ–≥–æ: ‚Ç¨<span id="cart-total">0.00</span></div>
          <div class="space-x-2">
            <button id="btn-checkout-eur" class="px-3 py-2 bg-emerald-600 text-white rounded">–û—Ñ–æ—Ä–º–∏—Ç—å (EUR)</button>
            <button id="btn-checkout-atm" class="px-3 py-2 bg-blue-600 text-white rounded">–û—Ñ–æ—Ä–º–∏—Ç—å (ATM)</button>
          </div>
        </div>
      </div>
    </section>

    <section id="wallet" class="tab hidden">
      <div class="card p-4 mb-4">
        <h2 class="text-xl font-semibold mb-2">–ö–æ—à–µ–ª—ë–∫</h2>
        <div id="wallet-balance" class="text-lg font-semibold mb-1">ATM: 0.00</div>
        <div class="muted text-sm mb-3">–ø—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ EUR: <span id="wallet-eur">0.00</span></div>
        <div class="grid grid-cols-2 gap-3">
          <button id="btn-daily" class="px-3 py-3 bg-indigo-600 text-white rounded">üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</button>
          <button id="btn-tap" class="px-3 py-3 bg-sky-600 text-white rounded tap-btn">üëâ –¢–ê–ü</button>
        </div>
      </div>
    </section>

    <section id="tasks" class="tab hidden">
      <div class="card p-4">
        <h2 class="text-xl font-semibold mb-2">–ó–∞–¥–∞–Ω–∏—è</h2>
        <p class="muted text-sm mb-3">–°–∫—Ä–∏–Ω/—Å—Å—ã–ª–∫–∞ –∫–∞–∫ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –∞–¥–º–∏–Ω –ø—Ä–æ–≤–µ—Ä–∏—Ç –∏ –Ω–∞—á–∏—Å–ª–∏—Ç ATM.</p>
        <div id="task-list" class="grid gap-3"></div>
      </div>
    </section>

    <section id="raffle" class="tab hidden">
      <div class="card p-4">
        <h2 class="text-xl font-semibold mb-2">–ú–µ—Å—è—á–Ω—ã–π —Ä–æ–∑—ã–≥—Ä—ã—à</h2>
        <p class="muted text-sm mb-2">–ß–µ–º –±–æ–ª—å—à–µ ATM ‚Äî —Ç–µ–º –≤—ã—à–µ —à–∞–Ω—Å. –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –≤—ã–ø–ª–∞—Ç–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—é.</p>
        <p class="muted text-sm">–ù–∞–±–∏—Ä–∞–π—Ç–µ –º–æ–Ω–µ—Ç—ã: —Ç–∞–ø–∞–π—Ç–µ, –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è, –æ—Ñ–æ—Ä–º–ª—è–π—Ç–µ –ø–æ–¥–ø–∏—Å–∫–∏!</p>
      </div>
    </section>

    <section id="ref" class="tab hidden">
      <div class="card p-4">
        <h2 class="text-xl font-semibold mb-2">–†–µ—Ñ–µ—Ä–∞–ª–∫–∞</h2>
        <p class="muted text-sm mb-2">–î–µ–ª–∏—Å—å —Å—Å—ã–ª–∫–æ–π ‚Äî –ø–æ–ª—É—á–∞–π ATM –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏ –ø–æ–¥–ø–∏—Å–∫—É –¥—Ä—É–≥–∞.</p>
        <input id="ref-link" class="w-full border rounded px-3 py-2 text-sm" readonly value=""/>
        <p class="muted text-xs mt-2">–°—Å—ã–ª–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (–±–æ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç –µ—ë —Ç–µ–∫—Å—Ç–æ–º).</p>
      </div>
    </section>

    <footer class="mt-8 mb-4 text-center muted text-xs">
      ¬© CryptoATM.tech
    </footer>
  </div>

  <script>
    const tg = window.Telegram?.WebApp;
    const REF = new URLSearchParams(location.search).get('ref') || '';
    const CATALOG = {
      bots: [
        {id:'bot_oracle', title:'AI –û—Ä–∞–∫—É–ª',  desc:'–ì–ª—É–±–æ–∫–∏–µ —Ä–∞—Å–∫–ª–∞–¥—ã, –ø—Ä–æ–≥–Ω–æ–∑—ã –∏ —á—Ç–µ–Ω–∏—è.', price_eur:19.9},
        {id:'bot_smm',    title:'AI SMM',     desc:'–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π.',    price_eur:24.9},
        {id:'bot_sales',  title:'AI Sales',   desc:'–°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–¥–∞–∂, –æ—Ñ—Ñ–µ—Ä—ã, –ø–∏—Å—å–º–∞.',     price_eur:29.9},
        {id:'bot_research',title:'AI Research',desc:'–°–±–æ—Ä –∏ –≤—ã–∂–∏–º–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.',          price_eur:24.9},
      ],
      bundles: [
        {id:'bundle_premium',   title:'Premium',   desc:'–û—Ä–∞–∫—É–ª+SMM+Sales',             price_eur:69.0, includes:['bot_oracle','bot_smm','bot_sales']},
        {id:'bundle_enterprise',title:'Enterprise',desc:'–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä + –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç',     price_eur:99.0, includes:['bot_oracle','bot_smm','bot_sales','bot_research']},
      ]
    };
    let CART = [];

    function send(action, payload={}) {
      if (!tg) { alert('–û—Ç–∫—Ä–æ–π —á–µ—Ä–µ–∑ Telegram'); return; }
      const data = {...payload, action, ref: REF};
      tg.sendData(JSON.stringify(data));
      // –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
      tg.HapticFeedback?.impactOccurred('light');
    }

    // Tabs
    const tabs = document.querySelectorAll('.tab');
    const btns = document.querySelectorAll('.tab-btn');
    btns.forEach(b => b.addEventListener('click', () => {
      const id = b.dataset.tab;
      tabs.forEach(t => t.classList.add('hidden'));
      document.getElementById(id)?.classList.remove('hidden');
    }));
    // default
    document.getElementById('plans').classList.remove('hidden');

    // Plans render
    const plansList = document.getElementById('plans-list');
    function renderPlans() {
      plansList.innerHTML = '';
      const drawCard = (p, type) => {
        const div = document.createElement('div');
        div.className = 'card p-3';
        div.innerHTML = `
          <div class="flex items-start justify-between">
            <div>
              <div class="font-semibold">${p.title}</div>
              <div class="muted text-sm">${p.desc}</div>
            </div>
            <div class="text-right">
              <div class="font-semibold">‚Ç¨${p.price_eur.toFixed(2)}/–º–µ—Å</div>
              <button class="mt-2 px-3 py-2 bg-emerald-600 text-white rounded text-sm add">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
          </div>
        `;
        div.querySelector('.add').onclick = () => {
          CART.push({id:p.id, title:p.title, eur:p.price_eur});
          updateCartBadge();
          send('cart_add', {item_id: p.id});
        };
        return div;
      };
      CATALOG.bots.forEach(p => plansList.appendChild(drawCard(p,'bot')));
      CATALOG.bundles.forEach(p => plansList.appendChild(drawCard(p,'bundle')));
    }
    renderPlans();

    function updateCartBadge() {
      const c = document.getElementById('cart-count');
      c.textContent = CART.length;
      c.classList.toggle('hidden', CART.length===0);
      const sum = CART.reduce((a,b)=>a+b.eur,0);
      document.getElementById('cart-total').textContent = sum.toFixed(2);
      renderCart();
    }

    // Cart
    const cartList = document.getElementById('cart-list');
    function renderCart() {
      cartList.innerHTML = '';
      CART.forEach((it, i) => {
        const row = document.createElement('div');
        row.className = 'flex items-center justify-between';
        row.innerHTML = `
          <div>
            <div class="font-medium">${it.title}</div>
            <div class="muted text-sm">‚Ç¨${it.eur.toFixed(2)}/–º–µ—Å</div>
          </div>
          <button class="px-3 py-1 bg-slate-200 rounded text-sm">–£–¥–∞–ª–∏—Ç—å</button>
        `;
        row.querySelector('button').onclick = () => {
          const removed = CART.splice(i,1)[0];
          updateCartBadge();
          send('cart_remove', {item_id: removed.id});
        };
        cartList.appendChild(row);
      });
    }
    document.getElementById('btn-clear-cart').onclick = () => {
      CART = [];
      updateCartBadge();
      send('cart_clear', {});
    };
    document.getElementById('btn-checkout-eur').onclick = () => {
      if (!CART.length) return alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
      send('checkout', {method:'eur'});
      CART = []; updateCartBadge();
      alert('–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω. –ë–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ–ø–ª–∞—Ç–µ EUR.');
    };
    document.getElementById('btn-checkout-atm').onclick = () => {
      if (!CART.length) return alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
      send('checkout', {method:'atm'});
      CART = []; updateCartBadge();
      alert('–ü—Ä–æ–±—É–µ–º —Å–ø–∏—Å–∞—Ç—å ATM. –†–µ–∑—É–ª—å—Ç–∞—Ç –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ–º.');
    };

    // Wallet
    document.getElementById('btn-tap').onclick = () => send('tap', {});
    document.getElementById('btn-daily').onclick = () => send('daily', {});

    // Tasks
    const TASKS = [
      {id:'instagram_follow', title:'–ü–æ–¥–ø–∏—Å–∫–∞ –≤ Instagram', coins:8.0, proof:true},
      {id:'story_repost',     title:'–†–µ–ø–æ—Å—Ç –≤ —Å—Ç–æ—Ä–∏—Å',    coins:12.0, proof:true},
      {id:'youtube_sub',      title:'–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ YouTube',coins:8.0, proof:true},
      {id:'invite_friend',    title:'–ü—Ä–∏–≥–ª–∞—Å–∏ –¥—Ä—É–≥–∞',     coins:20.0, proof:false},
    ];
    const tlist = document.getElementById('task-list');
    function renderTasks(){
      tlist.innerHTML='';
      TASKS.forEach(t=>{
        const el = document.createElement('div');
        el.className='card p-3';
        el.innerHTML = `
          <div class="flex items-center justify-between">
            <div>
              <div class="font-medium">${t.title}</div>
              <div class="muted text-sm">–ù–∞–≥—Ä–∞–¥–∞: +${t.coins.toFixed(1)} ATM</div>
            </div>
            <div class="flex items-center gap-2">
              ${t.proof ? '<input class="proof border rounded px-2 py-1 text-sm" placeholder="—Å—Å—ã–ª–∫–∞/—Å–∫—Ä–∏–Ω-—Å—Å—ã–ª–∫–∞"/>' : ''}
              <button class="px-3 py-2 bg-blue-600 text-white rounded text-sm">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
          </div>
        `;
        el.querySelector('button').onclick = ()=>{
          const proof = t.proof ? el.querySelector('.proof').value.trim() : '';
          send('task_submit', {task_id:t.id, proof});
          alert('–ó–∞–¥–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é. –û—Ç–≤–µ—Ç –ø—Ä–∏–¥—ë—Ç –æ—Ç –±–æ—Ç–∞.');
        };
        tlist.appendChild(el);
      });
    }
    renderTasks();

    // Bootstrap (–∑–∞–ø—Ä–æ—Å–∏–º —Å—Ç–µ–π—Ç —É –±–æ—Ç–∞, –æ–Ω –æ—Ç–≤–µ—Ç–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ–º)
    function bootstrap() { send('bootstrap', {}); }
    bootstrap();

    // UX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram
    if (tg) {
      tg.expand && tg.expand();
      tg.ready && tg.ready();
      tg.MainButton?.setText('–û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç —Å –±–æ—Ç–æ–º');
      tg.MainButton?.onClick(()=> tg.openTelegramLink?.('https://t.me/' + (tg.initDataUnsafe?.receiver?.username || '')));
    }
  </script>
</body>
</html>

