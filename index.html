<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>–û—Ä–∞–∫–ª ¬∑ Mini App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root { --bg:#0f1115; --card:#151925; --muted:#9aa4b2; --fg:#e8eef6; --accent:#8ab4ff; }
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.4 system-ui,Segoe UI,Roboto,Arial}
    .container{max-width:720px;margin:0 auto;padding:20px}
    .card{background:var(--card);border:1px solid #1f2433;border-radius:16px;padding:18px;box-shadow:0 8px 24px rgba(0,0,0,.25)}
    h1{font-size:20px;margin:0 0 12px}
    .grid{display:grid;gap:12px}
    label{display:block;font-size:13px;color:var(--muted);margin:4px 0}
    input,select,textarea{
      width:100%;padding:12px 14px;border-radius:12px;border:1px solid #2a3244;background:#0e1220;color:var(--fg);
      outline:none;transition:border .2s
    }
    input:focus,select:focus,textarea:focus{border-color:#334666}
    textarea{min-height:120px;resize:vertical}
    .btns{display:grid;gap:10px;margin-top:8px}
    button{
      width:100%;padding:12px 16px;border-radius:12px;border:1px solid #2a3244;background:#10182a;color:var(--fg);cursor:pointer;
      font-weight:600
    }
    button.primary{background:linear-gradient(180deg,#2a6fff,#1e52bf)}
    button.pay{background:#15351a;border-color:#265a2c}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .muted{color:var(--muted);font-size:13px}
    .top{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .tag{font-size:12px;padding:4px 8px;border-radius:999px;background:#0f253f;border:1px solid #214a74;color:#b7d4ff}
    footer{margin-top:18px;font-size:12px;color:var(--muted);text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <div class="card grid">
      <div class="top">
        <h1>üîÆ –û—Ä–∞–∫–ª ‚Äî –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h1>
        <span class="tag">beta</span>
      </div>

      <div class="grid">
        <label>–¢–µ–º–∞</label>
        <select id="topic">
          <option value="career">–ö–∞—Ä—å–µ—Ä–∞</option>
          <option value="love">–õ—é–±–æ–≤—å</option>
          <option value="finance">–§–∏–Ω–∞–Ω—Å—ã</option>
          <option value="health">–ó–¥–æ—Ä–æ–≤—å–µ</option>
          <option value="overall" selected>–û–±—â–µ–µ</option>
        </select>
      </div>

      <div class="row">
        <div>
          <label>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
          <input id="dob" type="date" />
        </div>
        <div>
          <label>–ü–æ–ª</label>
          <select id="gender">
            <option value="">‚Äî</option>
            <option value="male">–ú—É–∂—Å–∫–æ–π</option>
            <option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
            <option value="other">–î—Ä—É–≥–æ–µ</option>
          </select>
        </div>
      </div>

      <div class="grid">
        <label>–ö–æ–Ω—Ç–µ–∫—Å—Ç/–≤–æ–ø—Ä–æ—Å (1‚Äì2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)</label>
        <textarea id="context" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –∏—â—É –Ω–æ–≤—É—é —Ä–∞–±–æ—Ç—É, –≤–æ–ª–Ω—É—é—Å—å –∑–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ..."></textarea>
      </div>

      <div class="btns">
        <button class="primary" id="btn-mini">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∏–Ω–∏-—á—Ç–µ–Ω–∏–µ</button>
        <button class="primary" id="btn-deep">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≥–ª—É–±–æ–∫–æ–µ —á—Ç–µ–Ω–∏–µ (1 –∫—Ä–µ–¥–∏—Ç)</button>
        <button class="pay" id="btn-pay">–ö—É–ø–∏—Ç—å –∫—Ä–µ–¥–∏—Ç—ã –≤ ‚≠ê</button>
        <div class="muted">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏–¥—ë—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ—Ç –±–æ—Ç–∞ –≤ —ç—Ç–æ—Ç —á–∞—Ç.</div>
      </div>
    </div>
    <footer>‚ö†Ô∏è –†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å. –ù–µ –∑–∞–º–µ—â–∞–µ—Ç –ø—Ä–æ—Ñ. –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏.</footer>
  </div>

<script>
(function(){
  const tg = window.Telegram?.WebApp;
  if (tg) {
    tg.ready();
    tg.expand();           // —Ä–∞—Å—Ç—è–Ω—É—Ç—å –Ω–∞ –≤—Å—é –≤—ã—Å–æ—Ç—É
    tg.enableClosingConfirmation(); // –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  }

  function getForm() {
    return {
      topic:  document.getElementById('topic').value,
      dob:    document.getElementById('dob').value,      // YYYY-MM-DD (–∏–ª–∏ "")
      gender: document.getElementById('gender').value,   // male|female|other|""
      context:document.getElementById('context').value.trim()
    };
  }

  function send(action, extra={}) {
    const data = { action, ...getForm(), ...extra };
    try {
      tg?.sendData(JSON.stringify(data));
      // –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏:
      // tg?.close();
    } catch(e) {
      alert('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–æ—Ç. –û—Ç–∫—Ä–æ–π —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É /app.');
      console.error(e);
    }
  }

  document.getElementById('btn-mini').addEventListener('click', () => {
    send('gen', { mode: 'mini' });
  });

  document.getElementById('btn-deep').addEventListener('click', () => {
    send('gen', { mode: 'deep' });
  });

  document.getElementById('btn-pay').addEventListener('click', () => {
    send('pay');
  });
})();
</script>
</body>
</html>
